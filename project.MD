# üõ°Ô∏è VIGILANCE X - Live Active Response

**VIGILANCE X** est une solution de supervision de s√©curit√© et de r√©ponse active automatis√©e con√ßue sp√©cifiquement pour l'√©cosyst√®me **Sophos XGS**. Elle transforme les flux de logs passifs en actions d√©fensives imm√©diates gr√¢ce √† la corr√©lation intelligente et l'automatisation via API.

---

## üìã Table des Mati√®res
- [Vision & Objectifs](#vision--objectifs)
- [Architecture Technique](#architecture-technique)
- [Sources de Donn√©es & Corr√©lation](#sources-de-donn√©es--corr√©lation)
- [Moteur Detect2Ban](#moteur-detect2ban)
- [Fonctionnalit√©s WebUI](#fonctionnalit√©s-webui)
- [Installation & S√©curit√©](#installation--s√©curit√©)

---

## üéØ Vision & Objectifs
Le projet vise √† combler l'√©cart entre la d√©tection (logs) et la r√©action (blocage). 
- **Centraliser :** Collecter l'int√©gralit√© des logs Sophos XGS (Syslog).
- **Analyser :** Corr√©ler les √©v√©nements (WAF, IPS, ATP, Antivirus).
- **R√©agir :** Bannir automatiquement les attaquants via l'API XML du Sophos.
- **Visualiser :** Offrir une interface moderne d√©di√©e aux op√©rations de s√©curit√© (SOC).

---

## üèóÔ∏è Architecture Technique

### Stack Recommand√©e
- **OS :** Ubuntu Server 22.04+ (Partition 300Go pour `/var/lib/vigilance_x`)
- **Ingestion :** Vector.dev (Parser haute performance)
- **Base de Donn√©es :** ClickHouse (Stockage analytique des logs)
- **Backend :** Go ou Python (FastAPI)
- **Frontend :** React ou Vue.js (Tailwind CSS / Shadcn UI)
- **Communications :** - API XML Sophos (Port 4444)
    - SSH avec cl√© publique (R√©cup√©ration logs profonds)

---

## üîç Sources de Donn√©es & Corr√©lation
VIGILANCE X analyse les flux suivants pour identifier les comportements malveillants :

| Module | Log Type | Action Critique |
| :--- | :--- | :--- |
| **WAF** | `log_type="WAF"` | Blocage sur injections (SQLi, XSS). |
| **ATP** | `log_type="ATP"` | Isolement imm√©diat sur d√©tection de C&C. |
| **IPS** | `log_type="IPS"` | Bannissement sur Scan de ports / Exploits. |
| **Antivirus** | `log_type="Anti-Virus"` | Blocage des sources de distribution de Malware. |
| **Heartbeat** | `log_type="Heartbeat"` | Monitoring de l'√©tat de sant√© des endpoints (MDR). |
| **Threat Intel** | Flux Externes | Int√©gration Sophos X-Ops & AbuseIPDB. |

---

## ‚ö° Moteur Detect2Ban
Le c≈ìur du projet repose sur un moteur de d√©cision en 4 √©tapes :
1. **Parsing :** Normalisation des logs Syslog en JSON.
2. **Sc√©narios (YAML) :** D√©finition de seuils (ex: 5 drops WAF + 1 alerte IPS = Blocage).
3. **Validation :** V√©rification de la r√©putation de l'IP via des API tierces.
4. **Action LAR :** - Appel API Sophos pour ajout dans le groupe `VIGILANCE_X_BLOCKLIST`.
    - Notification Webhook (Discord/Slack).
    - Gestion du TTL (Expiration automatique du bannissement).

---

## üíª Fonctionnalit√©s WebUI
Interface "Dark Mode" structur√©e en 6 modules :
- **Dashboard :** Vue d'ensemble de la posture de s√©curit√©.
- **WAF Explorer :** Analyse d√©taill√©e du trafic Web prot√©g√©.
- **Attacks Analyzer :** Focus sur l'IPS et les tentatives d'intrusion.
- **Advanced Threat :** Suivi des alertes ATP et de la sant√© des h√¥tes (MDR).
- **VPN & Network :** Audit des acc√®s distants et performances interfaces.
- **Active Bans :** Gestion en temps r√©el des blocages en cours.

---

## üîí Installation & S√©curit√©
### Pr√©requis Sophos XGS
1. Activer l'API XML dans `System > Administration > API`.
2. Autoriser l'IP du serveur Vigilance X pour l'acc√®s API et SSH.
3. Cr√©er une r√®gle de Firewall prioritaire (Drop) utilisant le groupe `VIGILANCE_X_BLOCKLIST`.

### S√©curisation du Serveur LAR
- Acc√®s WebUI limit√© au LAN / VPN.
- Authentification MFA obligatoire.
- Chiffrement des logs au repos.

---
*Projet con√ßu pour une infrastructure hybride Cyber/DevOps. D√©velopp√© par l'√©quipe VIGILANCE X.*
