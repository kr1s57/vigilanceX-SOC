# VIGILANCE X - Detect2Ban Scenario
# WAF Attacks Detection and Auto-Ban
# Format compatible with engine.go loader

name: waf_attacks
description: Detect and ban IPs performing WAF attacks (5+ blocked requests in 5 minutes)
enabled: true
cooldown: "60m"

# Conditions that must be met (AND logic)
conditions:
  - field: log_type
    operator: eq
    value: WAF

  - field: action
    operator: eq
    value: drop

# Aggregation - count events per source IP
aggregation:
  group_by: src_ip
  window: "5m"
  threshold: 5

# Action to execute when conditions are met
action:
  type: ban
  duration: "1h"
  validate_threat: true
  threat_threshold: 50
  reason: "WAF: Multiple attack attempts detected ({count} events in 5 min)"
