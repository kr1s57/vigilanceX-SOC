# VIGILANCE X - Detect2Ban Scenario
# Brute Force Attack Detection
# Format compatible with engine.go loader

name: brute_force
description: Detect and ban IPs performing brute force attacks (10+ auth failures in 10 minutes)
enabled: true
cooldown: "30m"

# Conditions that must be met (AND logic)
conditions:
  - field: log_type
    operator: in
    value:
      - VPN
      - WAF
      - Firewall

  - field: category
    operator: in
    value:
      - Auth Failure
      - Brute Force
      - Login Failure

# Aggregation - count events per source IP
aggregation:
  group_by: src_ip
  window: "10m"
  threshold: 10

# Action to execute when conditions are met
action:
  type: ban
  duration: "4h"
  validate_threat: false
  threat_threshold: 0
  reason: "Brute Force: Multiple authentication failures ({count} attempts in 10 min)"
